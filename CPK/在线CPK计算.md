# 📊 CPK 计算工具

一个基于前端 HTML/JS 的 **CPK 计算与分析工具**，支持从 Excel/CSV 导入数据，生成统计表格与趋势图，无需后端服务即可使用。

---

## 功能特性

1. **Excel/CSV 导入**  
   - 支持 `.xlsx`、`.xls`、`.csv` 文件。
   - 自动解析表格数据，计算每个参数的统计信息。

2. **统计计算**  
   - 计算每个参数的：  
     - 最大值、最小值、平均值、标准差  
     - CP、CPK  
     - 超标数量与超标率  
     - 有效/无效数据数量

3. **数据可视化**  
   - 数据趋势图（均值、上下限、最大/最小值）  
   - CP / CPK 趋势图  
   - 超标率柱状图（显示超标数量）  
   - 单参数波动图（可选择参数查看趋势，带上下限线）

4. **有效/源数据切换**  
   - 支持切换显示仅有效数据或包含无效数据的完整数据。  
   - 图表和统计表会动态更新。

5. **美观响应式界面**  
   - 卡片式布局  
   - 支持多种颜色区分和图表样式  
   - 使用 Chart.js + ChartDataLabels 插件显示数据标签

---

## 使用方法

1. 打开 `index.html` 文件（在浏览器中打开即可，无需服务器）。  
2. 点击 **“选择文件”** 上传 Excel 或 CSV 文件。  
3. 查看生成的统计表格。  
4. 点击 **“生成统计图”** 查看数据趋势图、CP/CPK 图和超标率图。  
5. 可点击 **“参数波动图”** 选择单个参数查看波动趋势。  
6. 点击 **“切换有效/源数据显示”** 按钮切换显示模式。

---

## 数据格式要求

1. 表格第一行为表头，第一列为序号或 SN，第二列为时间/批次，后续列为各参数。  
2. 参数列的标题需带规格格式，例如：`参数1 50±5`。  
3. 参数值为数值类型，可包含空值或异常值（工具会自动识别有效数据）。

---

## 技术栈

- HTML5 + CSS3 + JavaScript  
- [XLSX.js](https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js) 用于解析 Excel/CSV  
- [Chart.js](https://www.chartjs.org/) + [chartjs-plugin-datalabels](https://chartjs-plugin-datalabels.netlify.app/) 用于数据可视化

---

## 注意事项

- 工具运行完全在前端，数据不上传服务器，保证隐私安全。  
- 对于非常大的表格，图表渲染可能略有延迟。  
- 参数列标题必须带规格信息，否则无法正确计算 CP/CPK。

---

## 联系与反馈

如有问题或改进建议，请联系开发者。

---

